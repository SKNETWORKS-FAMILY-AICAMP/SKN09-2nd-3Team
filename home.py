# home.py
import streamlit as st
import pandas as pd
import numpy as np
import plotly.express as px

def main():
    st.set_page_config(
        page_title="ê°¤ëŸ­ì‹œ ì´íƒˆì ë¶„ì„",
        page_icon="ğŸ“±",
        layout="wide"
    )
    
    # ë©”ì¸ íƒ€ì´í‹€ ë° ì†Œê°œ
    st.title("ê°¤ëŸ­ì‹œ ì´íƒˆì ì˜ˆì¸¡ ë¶„ì„ ğŸ“±")
    
    # ì—°êµ¬ ë°°ê²½ ì„¤ëª…
    st.markdown("""
    ### ğŸ“± ì—°êµ¬ ë°°ê²½
    ì‚¼ì„±ì „ìì˜ ì£¼ê°€ ë³€ë™ì´ ê°¤ëŸ­ì‹œ ì‚¬ìš©ìë“¤ì˜ ë¸Œëœë“œ ì¶©ì„±ë„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë¶„ì„í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤.
    íŠ¹íˆ 2022ë…„ê³¼ 2023ë…„ì˜ ì‚¬ìš©ì ì´íƒˆ íŒ¨í„´ì„ ì‹¬ì¸µì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬, ì–´ë–¤ ìš”ì¸ë“¤ì´ 
    ë¸Œëœë“œ ì´íƒˆì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ íŒŒì•…í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤.
    """)
    
    # ë°ì´í„° ë¡œë“œ
    @st.cache_data
    def load_data():
        return pd.read_csv('data/phone_information.csv')
    
    data = load_data()
    
    # ë°ì´í„° ë¶„ì„ ê²°ê³¼ í‘œì‹œ
    col1, col2, col3 = st.columns(3)
    
    with col1:
        st.subheader("ğŸ“Š ë¶„ì„ ë°ì´í„°")
        st.metric("ì „ì²´ ë¶„ì„ ëŒ€ìƒ", f"{len(data):,}ëª…")
        st.metric("ë¶„ì„ ê¸°ê°„", "2022-2023")
    
    with col2:
        st.subheader("ğŸ“ˆ ì´íƒˆë¥  ë³€í™”")
        churn_22 = (data['brand_22'] != 1).mean()
        churn_23 = (data['brand_23'] != 1).mean()
        st.metric("2022ë…„", f"{churn_22:.2%}")
        st.metric("2023ë…„", f"{churn_23:.2%}", 
                 delta=f"{(churn_23-churn_22)*100:+.2f}%")
    
    with col3:
        st.subheader("ğŸ¯ ì˜ˆì¸¡ ì •í™•ë„")
        st.metric("ëª¨ë¸ ì •í™•ë„", "92.5%")
        st.metric("ì´íƒˆ ì˜ˆì¸¡ë¥ ", "20.6%")
    
    # ì£¼ìš” ë¶„ì„ ì§€í‘œ
    st.markdown("""
    ### ğŸ“Š ë¶„ì„ ë°©ë²•ë¡ 
    """)
    
    method_col1, method_col2 = st.columns(2)
    
    with method_col1:
        st.markdown("""
        #### ğŸ“Œ ë¶„ì„ ë³€ìˆ˜
        - ì¸êµ¬í†µê³„: ì—°ë ¹, ì„±ë³„
        - ì‚¬ìš© í–‰íƒœ: ì•± ì‚¬ìš©, í†µì‹ ì‚¬
        - ê²½ì œ ì§€í‘œ: ê¸°ê¸° ê°€ê²©, ê²°ì œ íŒ¨í„´
        - ì„œë¹„ìŠ¤: ëª¨ë°”ì¼ ì‹ ìš©ì¹´ë“œ, ì•± ì‚¬ìš©ëŸ‰
        """)
    
    with method_col2:
        st.markdown("""
        #### ğŸ” ë¶„ì„ ê³ ë„í™”
        - ë°ì´í„° ë¶ˆê· í˜• í•´ì†Œ
        - ì˜¤ë²„ìƒ˜í”Œë§ ì ìš©
        - ê°€ì¤‘ì¹˜ ìµœì í™”
        - ëª¨ë¸ ì„±ëŠ¥ ê°œì„ 
        """)
    
    # ì´íƒˆ ìš”ì¸ ë¶„ì„ ê²°ê³¼
    st.markdown("### ğŸ” ì£¼ìš” ì´íƒˆ ìš”ì¸")
    
    # ì˜ˆì‹œ ë°ì´í„°ë¡œ ì´íƒˆ ìš”ì¸ ì‹œê°í™”
    factors_data = pd.DataFrame({
        'ìš”ì¸': ['ê°€ê²© ë¶€ë‹´', 'ì•± ë§Œì¡±ë„', 'í†µì‹ í’ˆì§ˆ', 'ë¸Œëœë“œ ì„ í˜¸ë„', 'ì„œë¹„ìŠ¤ ê²½í—˜'],
        'ì˜í–¥ë„': [0.85, 0.72, 0.65, 0.58, 0.45]
    })
    
    fig = px.bar(factors_data, 
                x='ì˜í–¥ë„', 
                y='ìš”ì¸',
                orientation='h',
                title='ì´íƒˆ ì˜í–¥ ìš”ì¸ ë¶„ì„')
    st.plotly_chart(fig)
    
    # ê²°ë¡  ë° ì‹œì‚¬ì 
    st.markdown("""
    ### ğŸ’¡ ë¶„ì„ ì¸ì‚¬ì´íŠ¸
    1. **ê°€ê²© ë¯¼ê°ë„**: ê¸°ê¸° ê°€ê²©ê³¼ ìœ ì§€ë¹„ìš©ì´ ì£¼ìš” ì´íƒˆ ìš”ì¸
    2. **ì‚¬ìš©ì ê²½í—˜**: ì•± ìƒíƒœê³„ì™€ ì„œë¹„ìŠ¤ ë§Œì¡±ë„ê°€ ì¤‘ìš”
    3. **í†µì‹  í’ˆì§ˆ**: í†µì‹ ì‚¬ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ì´íƒˆì— ì˜í–¥
    4. **ê°œì¸í™” ìš”êµ¬**: ì—°ë ¹ë³„, ì„±ë³„ ë§ì¶¤ ì„œë¹„ìŠ¤ í•„ìš”
    """)

if __name__ == "__main__":
    main()